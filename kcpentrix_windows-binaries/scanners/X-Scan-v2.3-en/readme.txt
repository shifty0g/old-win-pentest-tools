
X-Scan-v2.3 User Manual


1. System requirement: Windows 9x/NT4/2000


2. Introduction:

     X-Scan is a general network vulnerabilities scanner for scanning network vulnerabilities for specific IP address scope or stand-alone computer by multi-threading method. Plug-ins are supportable and GUI or CUI programs are separately provided. The following items can be scanned: remote OS type and version detection based on TCP/IP stack(like nmap), standard port status and port BANNER information, SNMP information, CGI vulnerability, IIS vulnerability, RPC vulnerability, SSL vulnerability, SQL-SERVER, FTP-SERVER, SMTP-SERVER, POP3-SERVER, NT-SERVER weak user/password pair prob, NT server NETBIOS information, Register information, etc. The result will be saved in /log/ directory, whose index can be found in index_*.htm which can be browsed by a Web Browser. For the known vulnerabilities, the corresponding descriptions and solutions are provided. As to other vulnerabilities, please refer to "Document" and "Vulnerability engine" in www.xfocus.org.


3. Components:

    xscan_gui.exe     --   X-Scan for Windows 9x/NT4/2000 GUI main program
    xscan.exe         --   X-Scan for Windows 9x/NT4/2000 CUI main program
    readme.txt        --   X-Scan help text
    oncrpc.dll        --   OncRpc dynamic link library for RPC-plug-in
    libeay32.dll      --   SSL implementation dynamic link library for SSL-plug-in
    /dat/language.ini --   multi-language database, language can be switched by setting "LANGUAGE\SELECTED" 
    /dat/config.ini   --   user configuration file, being used to save scanning port list, scanning settings and the names of all dictionary files (including relative paths)
    /dat/config.bak   --   backup file of "/dat/config.ini", used to restore the default configuration
    /dat/cgi.lst      --   CGI vulnerabilities list
    /dat/rpc.ini      --   used to save RPC program name and vulnerabilities list
    /dat/port.ini     --   used to save all the known ports and their corresponding services
    /dat/*_user.dic   --   username dictionary file, used to search weak-password user
    /dat/*_pass.dic   --   password dictionary, used to search weak password
    /dat/os.finger    --   used to distinguish the OS fingerprinter utilized by remote computer OS detection
    /plugin           --   used to save all plug-ins (whose suffix is .xpn). Plug-ins can also be saved in other subdirectories which are in the same directory as xscan.exe, and the program will search them automatically.

    Note: xscan_gui.exe & xscan.exe use the same plug-in and data file, but each will run independently.


4. Preparation:

    X-Scan which is absolutely free can be executed immediately after being decompressed without registration and installation. Under Windows 98/NT 4.0, it's impossible to distinguish remote OS by TCP/IP stack fingerprinter. Under Windows 98, it has restricted Netbios and SNMP scanning function due to the OS limitation.


5. Attention:

    1.When there's a too slow network connection, multithread scanning may bring local network block, resulting in connecting to network failure. Please adjust the corresponding thread number, or stop scanning CGI vulnerability at the time being. We suggest no cgi detection in large scope scanning, for there are so many cgi vulnerabilities, which would take you a lot of time.

    2.Only under Windows 2000, SYN of port scan and the identification ability of passive host OS are available, simultaneously, the perview of administrator is required.

    3.Dictionary shipped with X-Scan is a simple demo. To enhance cracking, you should improve the dictionary.

    4.In the scanning process, press "<space>" to view the lines and scanning schedule, press "q" to save current data and exit, press "<ctrl+c>" to close the program compulsively.


6. Command line parameter description:

    1.command format: xscan -host <start IP>[-<end IP>] <scanning items> [other options]
                      xscan -file <host list> < scanning items > [other options]

      Explanations of scanning items are as follow:
      -tracert  : track path information;
      -port     : scan the common port status (customizing scanning port list by modifying 
"PORT-SCAN-OPTIONS\PORT-LIST" in \dat\config.ini);
      -snmp     : scan SNMP information;
      -rpc      : scan RPC vulnerability;
      -sql      : scan SQL-Server weak password (setting user/password dictionary file by modifying \dat\config.ini);
      -ftp      : scan FTP weak (setting user/password dictionary file by modifying \dat\config.ini);
      -ntpass   : scan NT-Server weak password(setting user/password dictionary file by modifying \dat\config.ini);
      -netbios  : scan Netbios information;
      -smtp     : scan SMTP-Server vulnerability(setting user/password dictionary file by modifying \dat\config.ini);
      -pop3     : scan POP3-Server weak password (setting user/password dictionary file by modifying \dat\config.ini);
      -cgi      : scan CGI vulnerability(setting coding scheme by modifying "CGI-ENCODE\encode_type" in \dat\config.ini);
      -iis      : scan IIS vulnerability(setting coding scheme by modifying "CGI-ENCODE\encode_type" in \dat\config.ini);
      -bind     : scan BIND vulnerability;
      -finger   : scan Finger vulnerability;
      -sygate   : scan sygate vulnerability;
      -all      : scan all the above items;

      [other options] explanations:
      -v: display verbose information;
      -p: skip host when failed to ping;
      -o: skip host when no opened port be found;
      -t <thread_count[,host_count]>: specify the maximal thread count and host count, default is 100,10

      * Meaning of coding scheme in HTTP requests:
        1. Replace "GET" with "HEAD"
        2. Replace "GET" with "POST"
        3. Replace "GET" with "GET / HTTP/1.0\r\nHeader:" 
        4. Replace "GET" with "GET /[filename]?param=" (setting [filename] by modifying "CGI-ENCODE\encode4_index_file" in \dat\config.ini)
        5. Replace "GET" with "GET %00" 
        6. Several "/" or "\"
        7. Exchange of "/" and "\"
        8. Replace "<space>" with "<Tab>"
        Notes: the parameters can be used simultaneously  when there's no confliction.

    2.Exapmles:
      xscan -host xxx.xxx.1.1-xxx.xxx.255.255 -all -p
      Meaning: scan the vulnerabilities of all the hosts whose IP is between xxx.xxx.1.1-xxx.xxx.255.255, skip host when failed to ping;

      xscan -host xxx.xxx.1.1-xxx.xxx.255.255 -port -ntpass -t 150 -o
      Meaning: scan the standard port status and NT weak password user of all hosts whose IP is between xxx.xxx.1.1-xxx.xxx.255.255, skip host when no opened port be found. The max number of concurrent threads is 150;

      xscan -file host.lst -port -cgi -t 200,5 -v -o
      Meaning: scan the standard port status and CGI vulnerabilities of the hosts which is listed in "host.lst". The max number of concurrent threads is 200, and up to 5 hosts can be scanned simultaneously. Skip host when no opened port be found.


7. Plug-in Interface:

    #define PLUGIN_PARAMS_0     0
    #define PLUGIN_PARAMS_1     1
    #define PLUGIN_PARAMS_101   101
    #define PLUGIN_PARAMS_102   102
    #define PLUGIN_PARAMS_103   103
    #define PLUGIN_PARAMS_201   201

    /*
     -  AlertUser()
     -
     *  Function:
     *    form of string output:
     *    "[szHostName]: find [szVulnName] vulmerabilities-[szLine]"
     *    when szVlunName==NULL, form is as following:
     *    "[szHostName]: [szLine]"
     *
     *  Parameters:
     *    IN szHostName - file name
     *    IN szVulnName - vulnerabilities name
     *    IN szLine     - strings which will be inserted files
     *
     *  Returned data:
     *    [nothing]
     *
     */
    typedef VOID (CALLBACK *PALERT_USER) (
        char *szHostName,
        char *szVulnName,
        char *szLine);
    
    /*
     -  LogToFile()
     -    
     *  Function:
     *    insert strings into LOG file and mark with "<BR>" automatically
     *    allow strings carrying other HTML sentinels
     *
     *  Parameters:
     *    IN szLogFileName - LOG file name
     *    IN sLine         - strings waiting to be inserted files
     *
     *  Returned data:
     *    [nothing]
     *
     */
    typedef VOID (CALLBACK *PLOG_TO_FILE) (
        char *szLogFileName,
        char *szLine);
    
    /*
     -  AddToTreeView()
     -
     *  Function:
     *    add nodes to TreeView in the window of X-Scan-GUI
     *
     *  Parameters:
     *    IN szLine       - complete path of nodes and the list separator 
     *                      should be "\n" (for example "127.0.0.1\nPort\n80") 
     *    IN szImageFile  - node ico file (size of this ico file must be 16*16,
     *                      .bmp type) 
     *
     *  Returned data
     *    [nothing]
     *
     */
    typedef VOID (CALLBACK *PADD_TO_TREEVIEW) (
        char *szLine,
        char *szImageFile);
     
    /* plug-in basic information */
    typedef struct _PLUGIN_INFO {
        char    szClassName[50];        /* type of plug-in */
        char    szMemberName[50];       /* name of plug-in components */
        char    szVersion[10];          /* plug-in version */
        char    szFileName[50];         /* original file name of plug-in */
        char    szParamsRequest[50];    /* choose the parameters,such as "-cgi" */
        char    szPrompt[200];          /* explanation of parameter, such as "-cgi: check HTTP vulnerability" */
        int     nSingle;                /* if it's the only vulnerability(the number of vulnerability can be 1 or 0, such as Netbios information) */
        char    szAuthorName[50];       /* author of the plug-ins */
        char    szRisk[10];             /* vulnerability risk ranking */
        char    szDescription[300];     /* vulnerability description in plug-ins */
        char    szAdvice[300];          /* suggestion about vulnerability in plug-ins */
        DWORD   dwTimeOut;              /* time-out limitation, "0" stands for no limitation */
        int     nParamsType;            /* function type(PLUGIN_PARAMS_1) of plug-in export function "PluginFunc()" */
        int     nMark;                  /* identify whether this plug-in has been selected default */
        char    szImageFile[50];        /* 16*16.bmp ico file (locate in images direcotory without including path) */
    } PLUGIN_INFO;
    
    /* plug-in running basic parameters */
    typedef struct _SCAN_PARAMS_0 {
        char    szHostName[MAXLEN];     /* host address */
        char    szParams[MAXLEN];       /* user input parameters */
        int     nMaxThread;             /* max thread number */
        int     *pnThreadCount;         /* number of total active thread */
        int     *pnPluginThreadCount;   /* number of active thread what was created by current plug-in */
        char    *szCurrentSchedule;     /* current schedule */
        DWORD   *plTimeOut;             /* limitation of timeout, and "0" means no limit */
        int     nVerbose;               /* if display the detail information */
        char    szLogFileName[MAXLEN];  /* log file name(including the path) */
        char    szResultBuf[MAXLEN];    /* dynamical returned information */
        int     nVulnCount;             /* number of vulnerabilities */
    } SCAN_PARAMS_0;
    
    /* plug-in running parameters */
    typedef struct _SCAN_PARAMS_1 {
        SCAN_PARAMS_0       stBaseParams;   /* basic parameter (SCAN_PARAMS_0) */
        PALERT_USER         pAlertUser;     /* call-back function "AlertUser()" address */
        PLOG_TO_FILE        pLogToFile;     /* call-back function "LogToFile()" address */
        PADD_TO_TREEVIEW    pAddToTreeView; /* call-back function "AddToTreeView()" address */
    } SCAN_PARAMS_1;
    
    /* This function is quoted when initializing plug-ins, which is used to acquire the plug-in basic information.
       Returned value: TRUE -- plug-in initialized successfully; FALSE -- plug-in initialization failed */
    extern "C" __declspec(dllexport) BOOL GetPluginInfo(PLUGIN_INFO*);
    
    /* This function is quoted when scanning host. Input the host information and return the scanning result.
       Returned value: TRUE -- there are some vulnerabilities; FALSE -- there's no vulnerabilities */
    extern "C" __declspec(dllexport) BOOL PluginFunc(SCAN_PARAMS_1*);

    The above two functions should be generated before xscan.exe utilizing them. The final .dll program will be renamed to .xpn, and saved in the "plugin" subdirectory as xscan.exe. See the example "/plugin/sample.cpp".


8. Version Information:

    X-Scan v2.3     -- release date: 09/29/2002. Added the SSL-plug-in to check SSL vulnerability; updated PORT/HTTP/IIS-plug-in; updated GUI and changed it's style.
    Thank ilsy for excellent plug-ins.

    X-Scan v2.2     -- release date: 09/12/2002. Changed the style of result index file; enlarged RPC vulnerability database; revised known BUGs in the previous v2.1.
    Thank xundi, quack and stardust for neaten vulnerability database.

    X-Scan v2.1     -- release date: 09/08/2002. Allowed scanning specific SNMP-Info-plug-in options; Link "vulnerability description" of HTTP-plug-in, IIS-plug-in and RPC-plug-in to "xfocus" vulnerability search engine; revised all the known BUGs in the previous v2.0.

    X-Scan v2.0     -- release date: 08/07/2002. Added the TraceRoute-plug-in, SNMP-Info-plug-in; updated NETBIOS-plug-in, added remote register information scan; updated IIS-plug-in, added .ASP vulnerabities scan; modified part of plug-in interface; updated graphical interfaces, added "update online" function; enlarged CGI vulnerability database; revised all the known BUGs in the previous v1.3.
    Thank precious information or excellent plug-in provided by quack, stardust, sinister, ilsy, bingle, santa, and many thanks to our enthusiastic friends who have ever feed back with good suggestion.

    X-Scan v1.3     -- release date: 12/11/2001. Modify the OS-detection bug in PORT-plug-in.

    X-Scan v1.2     -- release date: 12/02/2001. Updated HTTP-plug-in and IIS-plug-in, added the detection of error pages which are redirected; updated PORT-plug-in, check port status by standard TCP connect() when fail to create Raw-Socket.

    X-Scan v1.1     -- release date: 11/25/2001. Transfered all scanning functions to plug-ins, and turn main program to contain; updated graphical interface program; modified multithreading mode, made plug-ins share threads and increase scanning speed; added SMTP, POP3 weak password scanning; added IIS UTF-Code vulnerabilities exploit; expanded CGI vulnerabilities list.
    My thanks to xundi, quack, casper, wollf and Huang Cheng for providing so much valuable information. A special thanks to xundi and quack for their hard work in testing this version.

    X-Scan v1.0(beta) -- release date: 07/12/2001. Added the detection of remote OS type and version based on TCP/IP stack fingerprinter; added the function of searching the geographical location of remote host; added the scanning of IIS ".ida/.idq" vulnerabilities in "-iis" option, and updated the description of this vulnerability; allowed scanning specific port scope (by modifying "[PORT-LIST]\port=" in "dat\config.ini"); allowed user using "%" to replace all user names when editing password dictionary in "-ntpass"; updated CGI vulnerabilities list,and clarified CGI vulnerabilities to increase the scanning speed.
    My thanks to cloud and Feng Zhihong for providing their great software. And thank you once again, quack, for your encouragement, faith, and support over the past years.

    X-Scanner v0.61 --  release date: 05/17/2001. Added the exploit of Microsoft IIS CGI Filename Decode Error Vulnerability in "-iis" option.

    X-Scanner v0.6  --  release date: 05/15/2001. Add "-iis" option, used to scan "unicode" & "remote .printer overflow" vulnerability of IIS server; updated the description of vulnerabilities; adjusted the timeouts, avoided "scan unfinished" caused by timeout; upload warning text to "C:\" instead of changing homepage automatically.

    X-Scanner v0.5  --  release date: 04/30/2001. Modified command line parameter, and made it more understandble; enlarged CGI vulnerability database; expanded the NT weak password scanning function.
    Thank santa and colossus for excellent plug-ins.

    X-Scanner v0.42b --  release date: 03/07/2001. Modify the bug in "-b" option.

    X-Scanner v0.42 --  release date: 03/02/2001. Allowed user extend SQL-SERVER account.

    X-Scanner v0.41 --  release date: 02/19/2001. Modified the scanning-weak-password bug in former versions; optimized the script, and combined xscan.exe and xscan98.

    X-Scanner v0.4  --  release date: 02/15/2001. Added the scan for SQL-SERVER default account "sa"; made a simple GUI temporarily (all work can be done by one mouse!)

    X-Scanner v0.31 --  release date: 01/17/2001. Adjusted the port scan way and the format of export files; enhanced the Unicode decode vulnerability; provided a simple CGI list maintenance tool for win98.

    X-Scanner v0.3  --  release date: 12/27/2000. Added the thread timeout limitation; added proxy; enlarge CGI vulnerability database, added the scan for vulnerabilities such as Unicode decoding; Modified the memory leak bug. Internal test version.

    X-Scanner v0.2  --  release date: 12/12/2000. Internal test version.


9. Appendix:

    X-Scan is a totally free software. Any suggestions and reflections are highly appreciated. I welcome email from any user with comments or bug fixes.

    Many thanks to the support of the members of xfocus, uid0 and ex-DarkSun. I can do nothing without you.

______________________________________________________________
Question, advice, bug ... please mail to£ºxscan@xfocus.org
Copyright (C) http://www.xfocus.org
